<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href='http://fonts.googleapis.com/css?family=Roboto:300,400,500,700,900' rel='stylesheet' type='text/css'>
    <!-- Page title -->
    <title>EY Document Intelligence</title>
    <!-- Vendor styles -->
    <link rel="stylesheet" href="/static/vendor/fontawesome/css/font-awesome.css">
    <link rel="stylesheet" href="/static/vendor/animate.css/animate.css">
    <link rel="stylesheet" href="/static/vendor/bootstrap/css/bootstrap.css">
    <link rel="icon" href="/static/images/EYBIicon.png" sizes="32x32">
    <link rel="icon" href="/static/images/EYBIicon.png" sizes="192x192">
    <!-- App styles -->
    <link rel="stylesheet" href="/static/styles/pe-icons/pe-icon-7-stroke.css">
    <link rel="stylesheet" href="/static/styles/pe-icons/helper.css">
    <link rel="stylesheet" href="/static/styles/stroke-icons/style.css">
    <link rel="stylesheet" href="/static/styles/upload.css">
    <link rel="stylesheet" href="/static/styles/style.css">
    <script src="/static/scripts/d3.v4.min.js"></script>
    <script src="/static/data/dbase/markers.js"></script>
    <script type='text/javascript' src='/static/scripts/angular.min.js'></script>
    <script type='text/javascript' src='/static/data/dbase/data.js'></script>
    <!--Import Google Icon Font-->
    <link href="https://cdn.jsdelivr.net/npm/materialize-stepper@2.1.4/materialize-stepper.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <!-- Materializecss compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/js/materialize.min.js"></script>
    <!-- jQueryValidation Plugin -->
    <script src="https://ajax.aspnetcdn.com/ajax/jquery.validate/1.15.0/jquery.validate.min.js"></script>
    <!-- <script type='text/javascript' src='data/data.js'></script> -->
    <style>
    @import url("https://fonts.googleapis.com/css?family=Lato:300,300italic")

    /*======= Map Styling ============*/
    a[href^="http://maps.google.com/maps"] {
        display: none !important
    }

    .gmnoprint a,
    .gmnoprint span {
        display: none;
    }

    .gmnoprint div {
        background: none !important;
    }

    #GMapsID div div a div img {
        display: none;
    }

    .checkmark-circle {
        width: 15px;
        height: 15px;
        position: relative;
        display: inline-block;
        vertical-align: top;
    }

    .checkmark-circle .background {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        background: #2EB150;
        position: absolute;
    }

    .checkmark-circle .checkmark {
        border-radius: 5px;
    }

    .checkmark-circle .checkmark.draw:after {
        -webkit-animation-delay: 100ms;
        -moz-animation-delay: 100ms;
        animation-delay: 100ms;
        -webkit-animation-duration: 1s;
        -moz-animation-duration: 1s;
        animation-duration: 1s;
        -webkit-animation-timing-function: ease;
        -moz-animation-timing-function: ease;
        animation-timing-function: ease;
        -webkit-animation-name: checkmark;
        -moz-animation-name: checkmark;
        animation-name: checkmark;
        -webkit-transform: scaleX(-1) rotate(135deg);
        -moz-transform: scaleX(-1) rotate(135deg);
        -ms-transform: scaleX(-1) rotate(135deg);
        -o-transform: scaleX(-1) rotate(135deg);
        transform: scaleX(-1) rotate(135deg);
        -webkit-animation-fill-mode: forwards;
        -moz-animation-fill-mode: forwards;
        animation-fill-mode: forwards;
    }

    .checkmark-circle .checkmark:after {
        opacity: 1;
        height: 75px;
        width: 37.5px;
        -webkit-transform-origin: left top;
        -moz-transform-origin: left top;
        -ms-transform-origin: left top;
        -o-transform-origin: left top;
        transform-origin: left top;
        border-right: 15px solid white;
        border-top: 15px solid white;
        border-radius: 2.5px !important;
        content: '';
        left: 25px;
        top: 75px;
        position: absolute;
    }

    @-webkit-keyframes checkmark {
        0% {
            height: 0;
            width: 0;
            opacity: 1;
        }

        20% {
            height: 0;
            width: 37.5px;
            opacity: 1;
        }

        40% {
            height: 75px;
            width: 37.5px;
            opacity: 1;
        }

        100% {
            height: 75px;
            width: 37.5px;
            opacity: 1;
        }
    }

    @-moz-keyframes checkmark {
        0% {
            height: 0;
            width: 0;
            opacity: 1;
        }

        20% {
            height: 0;
            width: 37.5px;
            opacity: 1;
        }

        40% {
            height: 75px;
            width: 37.5px;
            opacity: 1;
        }

        100% {
            height: 75px;
            width: 37.5px;
            opacity: 1;
        }
    }

    @keyframes checkmark {
        0% {
            height: 0;
            width: 0;
            opacity: 1;
        }

        20% {
            height: 0;
            width: 37.5px;
            opacity: 1;
        }

        40% {
            height: 75px;
            width: 37.5px;
            opacity: 1;
        }

        100% {
            height: 75px;
            width: 37.5px;
            opacity: 1;
        }
    }

    input {
        border: 1px solid transparent;
        background-color: #f1f1f1;
        padding: 10px;
    }

    .hoveryellow {
        color: white;
        transition: all .25s ease-in-out;
    }

    .hoveryellow:hover {
        background: rgba(255, 255, 255, 0.1);
        color: #fff;
        transition: background .25s ease-in-out;
        border-radius: 4px;
    }

    /* Lets Pop up */
    .letspop {}

    .letspop:hover {
        cursor: pointer;
    }

    .overlay {
        display: none;
        /* Default Hidden */
        position: fixed;
        left: 0;
        top: 0;
        z-index: 1;
        background-color: rgba(0, 0, 0, 0.6);
        height: 100%;
        width: 100%;
    }

    .popup {
        display: none;
        /* Default Hidden */
        position: fixed;
        left: 50%;
        top: 5%;
        z-index: 2;
        background: none;
        height: auto;
        width: auto;
        overflow: hidden;
        padding: 0px;
        transform: translate(-50%, 0);
    }


    /* Bored stuff & extras*/

    .close {
        position: absolute;
        top: 8px;
        right: 8px;
        display: block;
        color: #666666;
        font-family: sans-serif;
    }

    .close:hover {
        cursor: pointer;
        color: #444444;
    }

    @import url(https://fonts.googleapis.com/css?family=Lato:700italic,400,400italic,700);

    .container {
        width: 90%;
        margin: 0 auto;
        overflow: hidden;
        height: 100%;
    }

    .clear {
        clear: both;
    }

    .progress_bar {
        max-width: 820px;
        width: 80%;
        margin: 30px auto 0;
        position: relative;
        height: 50px;
        z-index: 10;
    }

    .progress_bar hr.all_steps {
        width: 80%;
        height: 5px;
        border: none;
        background: rgba(0, 0, 0, 0.3);
        //border-bottom: 1px solid #fff;
        position: absolute;
        bottom: -2px;
        left: 10%;
        z-index: 1;
    }

    .progress_bar hr.current_steps {
        width: 0%;
        border: 0;
        height: 4px;
        background: #ffe600;
        position: absolute;
        bottom: -1px;
        left: 10%;
        z-index: 1;
    }

    .progress_bar div.step {
        float: left;
        width: 20%;
        height: 50px;
        text-align: center;
        font-size: 12px;
        color: #ccc;
        position: relative;
        //text-shadow: 1px 1px #fff;
        -webkit-transition: all 0.3s ease-in;
        -moz-transition: all 0.3s ease-in;
        -ms-transition: all 0.3s ease-in;
        -o-transition: all 0.3s ease-in;
        transition: all 0.3s ease-in;
    }

    .progress_bar div.step:before {
        position: absolute;
        opacity: 0;
        width: 12px;
        height: 12px;
        border-radius: 20px;
        border: 2px solid transparent;
        background: #ffe600;
        bottom: 14px;
        left: 50%;
        margin-left: -6px;
        content: '';
        z-index: 4;
        display: none;
    }

    .progress_bar div.step:after {
        position: absolute;
        opacity: 0;
        width: 16px;
        height: 16px;
        border-radius: 20px;
        border: 2px solid #DDDDDD;
        background: #DDDDDD;
        bottom: 12px;
        left: 50%;
        margin-left: -8px;
        content: '';
        z-index: 2;
    }

    .progress_bar div.step.current {
        color: #fff;
    }

    .progress_bar div.step.current:before {
        display: block;
    }

    .progress_bar div.step.complete {
        color: #888;
        cursor: pointer;
    }

    .progress_bar div.step.complete:before {
        display: block;
    }

    .progress_bar div.step.complete:hover {
        color: #ffe600;
    }

    #blocks {
        width: 100%;
        position: relative;
        height: 200px;
    }

    #blocks .block {
        position: absolute;
        width: 100%;
        left: 100%;
        height: 200px;
    }

    #blocks .block .wrap {
        width: 80%;
        margin: 0 auto;
    }

    /* CSS BUTTON By https://codepen.io/daneden/pen/rcFJE*/
    .butt {
        /* Additions */
        cursor: pointer;
        margin-right: 5px;
        /* End Additions */
        font-size: .825em;
        text-decoration: none;
        font-weight: 700;
        padding: .35em 1em;
        background-color: #eaeef1;
        background-image: linear-gradient(rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.1));
        border-radius: 3px;
        color: rgba(0, 0, 0, 0.6);
        text-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);
        box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.2), 0 1px 2px rgba(0, 0, 0, 0.2), inset 0 1px 2px rgba(255, 255, 255, 0.7);
    }

    .butt:hover,
    .butt.hover {
        background-color: #fff;
    }

    .butt:active,
    .butt.active {
        background-color: #d0d3d6;
        background-image: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0));
        box-shadow: inset 0 0 2px rgba(0, 0, 0, 0.2), inset 0 2px 5px rgba(0, 0, 0, 0.2), 0 1px rgba(255, 255, 255, 0.2);
    }

    #map {
        height: 100%;
    }

    .gm-style-iw {
        border-radius: 3px !important;
    }

    .gm-style-iw-c {
        border-radius: 3px !important;
    }

    .gm-style-iw-d {
        min-height: 150px !important;
    }
    </style>
</head>

<body>
    <!-- Wrapper-->
    <div class="wrapper">
        <!-- Header-->
        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container-fluid">
                <div class="navbar-header">
                    <div id="mobile-menu">
                        <div class="left-nav-toggle">
                            <a href="#">
                                <i class="stroke-hamburgermenu"></i>
                            </a>
                        </div>
                    </div>
                    <a class="navbar-brand" style="background: #2f323b;" href="index.html">
                        <a href="Summary_KPI.html">
                            <img src="/static/images/EYBI.png" alt="" style="transform: scale(1.2); width: 134px; height:auto; max-width:100%; margin-left: -52%; margin-top: 4px;" />
                            <!--<span style="color:white;"> Business </br> Intelligence</span>-->
                        </a>
                    </a>
                </div>
            </div>
        </nav>
        </br>
        <!-- End header-->
        <!-- Navigation-->
        {% include '/eybi_nav.html' %}
        <!-- <div id="navbar-frame1"></div> -->
        <!-- End navigation-->
        <!-- Main content-->
        <section class="content" style="margin-top:30px;">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="view-header">
                            <ul class="nav nav-tabs btn-group pull-right">
                                <li class=""><button class="btn btn-default btn-xs left" style="border-top-right-radius: 0px; border-bottom-right-radius: 0px;"><a style="color: white;" id="tracking" onclick="myFunctionMap()">Map</a></button></li>
                                <li class="active"><button class="btn btn-default btn-xs right" style="border-top-left-radius: 0px; border-bottom-left-radius: 0px;"><a style="color: white; " onclick="myFunctionList()">List</a></button></li>
                            </ul>
                            <div class="header-icon">
                                <i class="pe page-header-icon pe-7s-home"></i>
                            </div>
                            <div class="header-title">
                                <h3 id="page_title">Distribution by State</h3>
                                <small>
                                    All Branches
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row modal-content" style="box-shadow:none; padding:1px;">
                    <div class="col-lg-12" style="padding:0px; box-shadow:none;">
                        <div style='font-size:10px; color:#eee; padding:5px;'>Click on a branch for details</div>
                        <div id="map" style="height:100vh"></div>
                        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDLqcibbpk8gljXFZdmplX-cpwqBFLOH2Q&callback=initMap" async defer></script>
                    </div>
                </div>
            </div>
        </section>
    </div>
    <!-- End main content-->
    <!-- End wrapper-->
    <!-- Vendor scripts -->
    <script src="/static/vendor/pacejs/pace.min.js"></script>
    <script src="/static/vendor/jquery/dist/jquery.min.js"></script>
    <script src="/static/vendor/bootstrap/js/bootstrap.min.js"></script>
    <!-- App scripts -->
    <!-- <script src="/static/scripts/luna.js"></script> -->
    <!--     <script>
    $(document).ready(function() {
        $("#navbar-frame1").load('/nav_bar');
    });
    </script> -->
    <script>
    $(document).ready(function() {
        $("#navbar-frame").load("/nav_bar");
    });

    function myFunctionMap() {
        window.location = "./branch_map";
    }

    function myFunctionList() {
        window.location = "./main_page";
    }
    </script>
    <script>
    window.localStorage.clear();
    window.localStorage.setItem('user', JSON.stringify(person));

    var theApp = angular.module('app', []);
    theApp.controller('ItemController', function ItemController($scope, $http, $filter, $timeout, $window) {
        $http.get('/static/data/dbase/data_class_result.json').success(function(data) {
            data = JSON.parse(window.localStorage.getItem('user'));
            $scope.persons = data;
            console.log("Ingest Data", data);
        });
        $scope.set_status = function() {
            $scope.persons.forEach(function(person) {
                if (person['Service_Type_Codes'] != 'IBOR') {
                    person.Status = "NA";
                } else {
                    person.Status = person.Status;
                };
            });
        };
        $scope.set_color = function(person) {
            if (person['Service_Type_Codes'] == 'IBOR') {
                return { color: "yellow" }
            } else
                return { color: "orange" }
        }
        $scope.updateHosts = function() {
            $scope.getData().forEach(function(person) {
                person.checked = $scope.allHosts;
            });
        }
        $scope.getData = function() { return $filter('filter')($scope.persons, $scope.query) };

        $scope.getSelected = function() {
            var selectedCounter = 0;
            var queryData = $scope.getData();
            var selectData = $filter('filter')(queryData, { "checked": true });
            angular.forEach(selectData, function(person) {
                if (person.checked) {
                    selectedCounter += 1;
                }
            });
            return [person.length, queryData]
        };

        $scope.clickButton = function(persons, query) {
            var data = $scope.getSelected(persons, query)[1];
            angular.forEach(data, function(person) {
                person.process = true
                person.Status = "Processing...."
                var delay = Math.floor(Math.random() * 5000);
                $timeout(function() {
                    person.Status = "Processed";
                    //person["City"] = new Date();
                    person.process = false;
                }, delay);
            });
        };

        $scope.colourIncludes = [];

        $scope.includeColour = function(colour) {
            var i = $.inArray(colour, $scope.colourIncludes);
            console.log($scope.colourIncludes)
            console.log(i)
            if (i > -1) {
                $scope.colourIncludes.splice(i, 1);
            } else {
                $scope.colourIncludes.push(colour);
            }
        }

        $scope.colourFilter = function(persons) {
            console.log(persons)
            if ($scope.colourIncludes.length > 0) {
                if ($.inArray(persons.colour, $scope.colourIncludes) < 0)
                    return;
            }

            return persons;
        }

        $scope.getProcess = function(person) {
            return (person.process);
        };
        $scope.hideButton = function() {
            return ($scope.getSelected()[0] == 0);
        };
        $scope.doc_classes = function() {
            var doc_type = [];
            angular.forEach($scope.persons, function(person) {
                if (doc_type.indexOf(person["Zip_Code"]) === -1) {
                    doc_type.push(person["Zip_Code"]);
                }
            });
            return doc_type;
        };
        $scope.addToList = function(id) {
            $scope.checkboxes.push(id);
        };
        $scope.getDownload = function() {
            var doc_class = $scope.selectedDoc;
            // console.log(doc_class);
            for (i in doc_class) {
                var val_array = $scope.fetchJSON($scope.persons, "Zip_Code", [doc_class[i]]);
                var selectData = $filter('filter')(val_array, { "Status": "Processed" });
                var fileList = []
                for (var j = 0; j < selectData.length; j++) {
                    fileList.push(selectData[j]["Office_Address"]);
                };
                if (doc_class[i] == "Syndicated Loan") {
                    var out_data = $scope.fetchJSON($scope.data_model[i], "Name", fileList);
                } else {
                    var out_data = $scope.fetchJSON($scope.data_model[i], "Full File Name", fileList)
                };
                $scope.exportData(out_data, doc_class[i])
            };
        };

        $scope.selectedDoc = [];
        $scope.toggleCheck = function(doc_class) {
            if ($scope.selectedDoc.indexOf(doc_class) === -1) {
                $scope.selectedDoc.push(doc_class);
            } else {
                $scope.selectedDoc.splice($scope.selectedDoc.indexOf(doc_class), 1);
            }
        };
        $scope.exportData = function JSONToCSVConvertor(JSONData, ReportTitle, ShowLabel = true) {
            var arrData = typeof JSONData != 'object' ? JSON.parse(JSONData) : JSONData;
            var CSV = '';

            CSV += ReportTitle + '\r\n\n';

            if (ShowLabel) {
                var row = "";
                for (var index in arrData[0]) {
                    row += index + ',';
                }
                row = row.slice(0, -1);
                CSV += row + '\r\n';
            }
            for (var i = 0; i < arrData.length; i++) {
                var row = "";
                for (var index in arrData[i]) {
                    row += '"' + arrData[i][index] + '",';
                }

                row.slice(0, row.length - 1);
                CSV += row + '\r\n';
            }

            if (CSV == '') {
                alert("Invalid data");
                return;
            }

            //Generate a file name
            var fileName = "DataModel_";
            fileName += ReportTitle.replace(/ /g, "_");

            //Initialize file format you want csv or xls
            var uri = 'data:text/csv;charset=utf-8,' + escape(CSV);
            //this trick will generate a temp <a /> tag
            var link = document.createElement("a");
            link.href = uri;

            //set the visibility hidden so it will not effect on your web-layout
            link.style = "visibility:hidden";
            link.download = fileName + ".csv";
            //this part will append the anchor tag and remove it after automatic click
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        $scope.fetchJSON = function(JSON_data, key, array) {
            var foo = $filter('filter')(JSON_data, function(item) {
                return array.indexOf(item[key]) !== -1;
            });
            return foo;
        };
    });
    // The class you click to trigger the popup 
    $('.letspop').on('click', function() {
        // The Overlay fades in
        $(".overlay").fadeIn(200, function() {});
        // The Popup fades in just after
        $(".popup").fadeIn(600, function() {});
    });
    // The class's you click when you want to close the pop
    $('.overlay, .close-pop').on('click', function() {
        // The Overlay fades out slower
        $(".overlay").fadeOut(600, function() {});
        // The Popup fades out faster
        $(".popup").fadeOut(200, function() {});
    });

    d3.csv("/static/data/datamodel/Signature_model.csv", function(data) {


        var documents_flag = 0;
        var variables = data.columns;
        console.log(variables)
        variables.forEach(function(d) {
            if (d == 'Branch Uninum') {
                for (var i = 0; i < 300; i += 1) {

                    try {

                        if (typeof(data[i]) != "undefined") {
                            documents_flag++;
                        }
                    } catch (e) {
                        console.log('An error has occurred: ' + e.message);
                    }

                }
            }

        });

        console.log(documents_flag);

        variables.forEach(function(d) {


            for (var i = 0; i < documents_flag; i += 1) {

                if (data[i][' Office Address'].includes(file_name)) {

                    var perm_disc = data[i]['Box'];
                    console.log(perm_disc);
                }
            }
        });

    });
    </script>
    <script>
    function step_process(from, to, dir) {
        if (typeof(dir) === 'undefined') dir = 'asc';
        var old_move = '';
        var new_start = '';

        var speed = 500;

        if (dir == 'asc') {
            old_move = '-';
            new_start = '';
        } else if (dir == 'desc') {
            old_move = '';
            new_start = '-';
        }

        $('#block' + from).animate({ left: old_move + '100%' }, speed, function() {
            $(this).css({ left: '100%', 'background-color': 'transparent', 'z-index': '2' });
        });
        $('#block' + to).css({ 'z-index': '3', left: new_start + '100%' }).animate({ left: '0%' }, speed, function() {
            $(this).css({ 'z-index': '2' });
        });

        if (Math.abs(from - to) === 1) {
            // Next Step
            if (from < to) $("#step" + from).addClass('complete').removeClass('current');
            else $("#step" + from).removeClass('complete').removeClass('current');
            var width = (parseInt(to) - 1) * 20;
            $(".progress_bar").find('.current_steps').animate({ 'width': width + '%' }, speed, function() {
                $("#step" + to).removeClass('complete').addClass('current');
            });
        } else {
            // Move to Step
            var steps = Math.abs(from - to);
            var step_speed = speed / steps;
            if (from < to) {
                move_to_step(from, to, 'asc', step_speed);
            } else {
                move_to_step(from, to, 'desc', step_speed);
            }
        }
    }

    function move_to_step(step, end, dir, step_speed) {
        if (dir == 'asc') {
            $("#step" + step).addClass('complete').removeClass('current');
            var width = (parseInt(step + 1) - 1) * 20;
            $(".progress_bar").find('.current_steps').animate({ 'width': width + '%' }, step_speed, function() {
                $("#step" + (step + 1)).removeClass('complete').addClass('current');
                if (step + 1 < end) move_to_step((step + 1), end, dir, step_speed);
            });
        } else {
            $("#step" + step).removeClass('complete').removeClass('current');
            var width = (parseInt(step - 1) - 1) * 20;
            $(".progress_bar").find('.current_steps').animate({ 'width': width + '%' }, step_speed, function() {
                $("#step" + (step - 1)).removeClass('complete').addClass('current');
                if (step - 1 > end) move_to_step((step - 1), end, dir, step_speed);
            });
        }
    }

    $(document).ready(function() {
        $("body").on("click", ".progress_bar .step.complete", function() {
            var from = $(this).parent().find('.current').data('step');
            var to = $(this).data('step');
            var dir = "desc";
            if (from < to) dir = "asc";

            step_process(from, to, dir);
        });
    });
    </script>
    <script>
    // styles for the map
    var styles =

        // IF YOU WANT TO TRY OTHER STYLES FROM SNAZZYMAPS, paste the JSON array here!!! 


        [{
                "featureType": "all",
                "elementType": "labels.text.fill",
                "stylers": [{
                        "saturation": 36
                    },
                    {
                        "color": "#060607"
                    },
                    {
                        "lightness": 40
                    }
                ]
            },
            {
                "featureType": "all",
                "elementType": "labels.text.stroke",
                "stylers": [{
                        "visibility": "on"
                    },
                    {
                        "color": "#060607"
                    },
                    {
                        "lightness": 16
                    }
                ]
            },
            {
                "featureType": "all",
                "elementType": "labels.icon",
                "stylers": [{
                    "visibility": "off"
                }]
            },
            {
                "featureType": "administrative",
                "elementType": "geometry.fill",
                "stylers": [{
                        "color": "#060607"
                    },
                    {
                        "lightness": 20
                    }
                ]
            },
            {
                "featureType": "administrative",
                "elementType": "geometry.stroke",
                "stylers": [{
                        "color": "#060607"
                    },
                    {
                        "lightness": 17
                    },
                    {
                        "weight": 1.2
                    }
                ]
            },
            {
                "featureType": "landscape",
                "elementType": "geometry",
                "stylers": [{
                        "color": "#060607"
                    },
                    {
                        "lightness": 20
                    }
                ]
            },
            {
                "featureType": "poi",
                "elementType": "geometry",
                "stylers": [{
                        "color": "#060607"
                    },
                    {
                        "lightness": 21
                    }
                ]
            },
            {
                "featureType": "road.highway",
                "elementType": "geometry.fill",
                "stylers": [{
                        "color": "#060607"
                    },
                    {
                        "lightness": 17
                    }
                ]
            },
            {
                "featureType": "road.highway",
                "elementType": "geometry.stroke",
                "stylers": [{
                        "color": "#060607"
                    },
                    {
                        "lightness": 29
                    },
                    {
                        "weight": 0.2
                    }
                ]
            },
            {
                "featureType": "road.arterial",
                "elementType": "geometry",
                "stylers": [{
                        "color": "#060607"
                    },
                    {
                        "lightness": 18
                    }
                ]
            },
            {
                "featureType": "road.local",
                "elementType": "geometry",
                "stylers": [{
                        "color": "#060607"
                    },
                    {
                        "lightness": 16
                    }
                ]
            },
            {
                "featureType": "transit",
                "elementType": "geometry",
                "stylers": [{
                        "color": "#060607"
                    },
                    {
                        "lightness": 19
                    }
                ]
            },
            {
                "featureType": "water",
                "elementType": "geometry",
                "stylers": [{
                        "color": "#060607"
                    },
                    {
                        "lightness": 17
                    }
                ]
            }
        ]

    // END array of map styles

    ;

    // JSON for markers


    window.onload = function() {
        LoadMap();
    }

    function LoadMap() {
        var mapOptions = {
            center: new google.maps.LatLng(markers[0].lat, markers[0].lng),
            zoom: 8,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            controlSize: 20,
            mapTypeControl: false,
            scaleControl: false,
            streetViewControl: false,
            overviewMapControl: false
        };
        var infoWindow = new google.maps.InfoWindow();
        var latlngbounds = new google.maps.LatLngBounds();
        var map = new google.maps.Map(document.getElementById("map"), mapOptions);

        for (var i = 0; i < markers.length; i++) {
            var data = markers[i]
            var title = data.title;
            var status = data.status;
            var myLatlng = new google.maps.LatLng(data.lat, data.lng);
            var pin = {
                path: 'M12.8,0c0,6.9-5.6,12.5-12.5,12.5S-12.2,6.9-12.2,0c0-4.4,2.3-8.3,5.8-10.5c1.9-1.2,4.2-2,6.7-2C7.2-12.5,12.8-6.9,12.8,0z',
                fillColor: '#019b51',
                fillOpacity: .95,
                scale: .875,
                strokeColor: '#019b51',
                strokeWeight: 7,
                strokeOpacity: 0.5,
            };
            var pinGreen = {
                path: 'M12.8,0c0,6.9-5.6,12.5-12.5,12.5S-12.2,6.9-12.2,0c0-4.4,2.3-8.3,5.8-10.5c1.9-1.2,4.2-2,6.7-2C7.2-12.5,12.8-6.9,12.8,0z',
                fillColor: '#991d1d',
                fillOpacity: .95,
                scale: .875,
                strokeColor: '#991d1d',
                strokeWeight: 7,
                strokeOpacity: 0.5,
            };
            var pinRed = {
                path: 'M12.8,0c0,6.9-5.6,12.5-12.5,12.5S-12.2,6.9-12.2,0c0-4.4,2.3-8.3,5.8-10.5c1.9-1.2,4.2-2,6.7-2C7.2-12.5,12.8-6.9,12.8,0z',
                fillColor: '#019b51',
                fillOpacity: .95,
                scale: .875,
                strokeColor: '#019b51',
                strokeWeight: 7,
                strokeOpacity: 0.5,
            };
            var marker = new google.maps.Marker({
                position: myLatlng,
                map: map,
                icon: pin,
                title: data.title
            });
            console.log('status:' + status)
            if (status.includes('Request')) {
                marker.setIcon(pinGreen)
            } else {

            }
            (function(marker, data) {
                google.maps.event.addListener(marker, "click", function(e) {
                    infoWindow.setContent(
                        "<div class='local-info-window' style='color:#555; border-radius:3px; font-size:10px;'>" +
                        "<h5 style='color:#555;'>" + "<a href = '/branch_documents?Use_Id=+" + data.title + "''>" +
                        data.title + "</a>"+
                        "</br>" + data.city  +
                        "</h5>" +
                        "</br>" +
                        "<div style='color:#555;'> Status: " +
                        "<span class='label label-accent' style='background:" + data.status_color + "; font-size:10px;' >" + data.status + "</span>" +
                        "</div>" +
                        "<div style='margin-top:5px; color:#555;'> Total Documents: " +
                        "<span class='label label-accent' style='background:rgba(0,0,0,0); color:#555; font-size:10px;'>" + data.total_documents + "</span>" +
                        "</div>" +
                        "<div style='margin-top:5px; color:#555;'> Verified Documents: " +
                        "<span class='label label-accent' style='background:rgba(0,0,0,0);  color:#555; font-size:10px;'>" + data.verified_documents + "</span>" +
                        "</div>" +
                        "<div style='margin-top:5px; color:#555;'> Source: " +
                        "<span class='label label-accent' style='background:rgba(0,0,0,0.7); font-size:10px;'>" + data.source + "</span>" +
                        "</div>" +
                        "</div>"
                    );
                    infoWindow.open(map, marker);
                    var iwBackground = $(".gm-style-iw").prev();
                    var iwCloseBtn = $(".gm-style-iw").next();

                    // Add a class to the tail's shadow
                    iwBackground.children(':nth-child(1)').addClass('infowindow-tail-shadow');

                    // Add a class to the background shadow DIV
                    iwBackground.children(':nth-child(2)').addClass('infowindow-shadow');

                    // Add a class to the white background DIV
                    iwBackground.children(':nth-child(4)').addClass('infowindow-background');

                    // Add a class to the tail outline.
                    // The outline of the tail is composed of two descendants of div which contains the tail.
                    iwBackground.children(':nth-child(3)').find('div').children().addClass('infowindow-tail');

                    // Add a class to the close button
                    iwCloseBtn.addClass('infowindow-close');
                });
            })(marker, data);
            latlngbounds.extend(marker.position);
        }
        var bounds = new google.maps.LatLngBounds();
        map.setCenter(latlngbounds.getCenter());
        map.fitBounds(latlngbounds);
        map.setOptions({ styles: styles });



        var myLatlng = { lat: -25.363, lng: 131.044 };

        function placeMarkerAndPanTo(latLng, map) {
            map.panTo(myLatlng);
        }

        map.addListener('click', function(e) {
            placeMarkerAndPanTo(e.latLng, map);
        });
    }



    /*
     * The google.maps.event.addListener() event waits for
     * the creation of the infowindow HTML structure 'domready'
     * and before the opening of the infowindow defined styles
     * are applied.
     */
    google.maps.event.addListener(infoWindow, 'domready', function() {


    });
    </script>
</body>

</html>